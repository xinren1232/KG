#!/usr/bin/env python3
"""
创建示例Excel文件
用于演示数据导入功能
"""

import pandas as pd
from pathlib import Path

def create_test_cases_excel():
    """创建测试用例示例Excel"""
    data = [
        {
            "产品名称": "iPhone 15",
            "组件名称": "摄像头模块",
            "用例ID": "TC-CAM-001",
            "用例标题": "摄像头对焦功能测试",
            "用例描述": "验证摄像头在各种光线条件下的对焦功能",
            "优先级": "high",
            "类型": "functional",
            "测试步骤": "1. 打开相机应用\n2. 切换到拍照模式\n3. 点击屏幕进行对焦\n4. 验证对焦效果",
            "期望结果": "摄像头能够正常对焦，图像清晰"
        },
        {
            "产品名称": "iPhone 15",
            "组件名称": "摄像头模块",
            "用例ID": "TC-CAM-002",
            "用例标题": "摄像头变焦功能测试",
            "用例描述": "验证摄像头变焦功能的正常性",
            "优先级": "medium",
            "类型": "functional",
            "测试步骤": "1. 打开相机应用\n2. 使用手势进行变焦\n3. 验证变焦效果",
            "期望结果": "变焦功能正常，图像质量良好"
        },
        {
            "产品名称": "iPhone 15",
            "组件名称": "电池模块",
            "用例ID": "TC-BAT-001",
            "用例标题": "电池充电功能测试",
            "用例描述": "验证电池充电功能的正常性",
            "优先级": "high",
            "类型": "functional",
            "测试步骤": "1. 连接充电器\n2. 观察充电指示\n3. 检查充电速度",
            "期望结果": "电池能够正常充电，充电指示正确"
        },
        {
            "产品名称": "Galaxy S24",
            "组件名称": "屏幕模块",
            "用例ID": "TC-SCR-001",
            "用例标题": "屏幕触控功能测试",
            "用例描述": "验证屏幕触控响应的准确性",
            "优先级": "high",
            "类型": "functional",
            "测试步骤": "1. 在屏幕各区域进行点击\n2. 测试多点触控\n3. 验证触控响应时间",
            "期望结果": "触控响应准确，无延迟"
        },
        {
            "产品名称": "Galaxy S24",
            "组件名称": "WiFi模块",
            "用例ID": "TC-WIFI-001",
            "用例标题": "WiFi连接功能测试",
            "用例描述": "验证WiFi连接的稳定性",
            "优先级": "medium",
            "类型": "functional",
            "测试步骤": "1. 搜索WiFi网络\n2. 连接指定网络\n3. 测试网络稳定性",
            "期望结果": "WiFi连接稳定，网速正常"
        }
    ]
    
    df = pd.DataFrame(data)
    file_path = Path("data/raw/测试用例样本数据.xlsx")
    file_path.parent.mkdir(parents=True, exist_ok=True)
    df.to_excel(file_path, index=False)
    print(f"✅ 创建测试用例Excel: {file_path}")

def create_anomaly_excel():
    """创建异常数据示例Excel"""
    data = [
        {
            "异常ID": "ANO-2024-001",
            "异常标题": "摄像头无法对焦",
            "异常描述": "在低光环境下摄像头无法正常对焦，影响拍照质量",
            "严重程度": "high",
            "状态": "resolved",
            "组件名称": "摄像头模块",
            "症状描述": "摄像头对焦失败，图像模糊",
            "根因描述": "传感器校准偏差导致对焦算法失效",
            "对策描述": "重新校准摄像头传感器，更新对焦算法",
            "创建日期": "2024-01-15",
            "报告人": "张三"
        },
        {
            "异常ID": "ANO-2024-002",
            "异常标题": "电池充电速度慢",
            "异常描述": "电池充电速度明显低于规格要求",
            "严重程度": "medium",
            "状态": "in_progress",
            "组件名称": "电池模块",
            "症状描述": "充电时间超过预期，充电指示异常",
            "根因描述": "充电芯片温度过高导致充电功率限制",
            "对策描述": "优化散热设计，调整充电策略",
            "创建日期": "2024-01-20",
            "报告人": "李四"
        },
        {
            "异常ID": "ANO-2024-003",
            "异常标题": "屏幕触控不响应",
            "异常描述": "屏幕特定区域触控无响应",
            "严重程度": "high",
            "状态": "open",
            "组件名称": "屏幕模块",
            "症状描述": "屏幕右上角区域触控失效",
            "根因描述": "触控IC连接异常",
            "对策描述": "检查并重新焊接触控IC连接",
            "创建日期": "2024-01-25",
            "报告人": "王五"
        },
        {
            "异常ID": "ANO-2024-004",
            "异常标题": "WiFi连接不稳定",
            "异常描述": "WiFi连接频繁断开重连",
            "严重程度": "medium",
            "状态": "resolved",
            "组件名称": "WiFi模块",
            "症状描述": "WiFi信号强度波动，连接不稳定",
            "根因描述": "天线设计问题导致信号干扰",
            "对策描述": "重新设计天线布局，增加屏蔽措施",
            "创建日期": "2024-01-18",
            "报告人": "赵六"
        },
        {
            "异常ID": "ANO-2024-005",
            "异常标题": "摄像头夜景模式异常",
            "异常描述": "夜景模式下拍照出现噪点过多",
            "严重程度": "low",
            "状态": "open",
            "组件名称": "摄像头模块",
            "症状描述": "夜景照片噪点明显，画质下降",
            "根因描述": "图像处理算法对低光环境优化不足",
            "对策描述": "优化夜景模式算法，增强降噪处理",
            "创建日期": "2024-01-22",
            "报告人": "孙七"
        }
    ]
    
    df = pd.DataFrame(data)
    file_path = Path("data/raw/异常数据样本.xlsx")
    file_path.parent.mkdir(parents=True, exist_ok=True)
    df.to_excel(file_path, index=False)
    print(f"✅ 创建异常数据Excel: {file_path}")

def main():
    """主函数"""
    print("📊 创建示例Excel文件...")
    create_test_cases_excel()
    create_anomaly_excel()
    print("\n✅ 示例Excel文件创建完成！")
    print("\n📋 使用说明:")
    print("1. 查看生成的Excel文件了解数据格式")
    print("2. 根据实际需求修改或替换数据")
    print("3. 运行ETL脚本导入数据:")
    print("   cd services/etl")
    print("   python excel_processor.py")

if __name__ == "__main__":
    main()
