# ç¬¬å››è½®ä¿®å¤æ€»ç»“ - çœŸå®æ•°æ®é›†æˆ

## ğŸ“‹ ä¿®å¤çš„é—®é¢˜

### é—®é¢˜ï¼šç³»ç»Ÿç®¡ç†é¡µé¢æ˜¾ç¤ºçš„æ˜¯ç¡¬ç¼–ç çš„æ¨¡æ‹Ÿæ•°æ®

**é—®é¢˜æè¿°**:
- ç³»ç»Ÿç®¡ç†é¡µé¢é¡¶éƒ¨çš„ç»Ÿè®¡å¡ç‰‡ï¼ˆç‰ˆæœ¬ã€è§„åˆ™æ•°ã€Promptæ•°ç­‰ï¼‰æ˜¾ç¤ºçš„æ˜¯å†™æ­»çš„æ•°æ®
- åç«¯ `/system/status` API è¿”å›çš„ä¹Ÿæ˜¯ç¡¬ç¼–ç çš„æ¨¡æ‹Ÿæ•°æ®
- å‰ç«¯æ²¡æœ‰æ­£ç¡®è°ƒç”¨ API è·å–çœŸå®æ•°æ®

**å½±å“èŒƒå›´**:
- ç³»ç»Ÿç®¡ç†ä¸­å¿ƒçš„æ¦‚è§ˆä»ªè¡¨æ¿
- æ‰€æœ‰ç»Ÿè®¡æ•°å­—ä¸åæ˜ çœŸå®çš„æ•°æ®åº“çŠ¶æ€

## âœ… ä¿®å¤æ–¹æ¡ˆ

### 1. åç«¯ä¿®å¤ - `/system/status` API è¿”å›çœŸå®æ•°æ®

**ä¿®å¤å‰**:
```python
@app.get("/system/status")
async def get_system_status():
    """è·å–ç³»ç»ŸçŠ¶æ€"""
    try:
        # ...
        # è·å–è§„åˆ™æ•°é‡ï¼ˆæ¨¡æ‹Ÿï¼‰
        rule_count = 12  # âŒ ç¡¬ç¼–ç 

        # è·å–Promptæ¨¡æ¿æ•°é‡ï¼ˆæ¨¡æ‹Ÿï¼‰
        prompt_count = 8  # âŒ ç¡¬ç¼–ç 

        # è·å–ä¸šåŠ¡åœºæ™¯æ•°é‡ï¼ˆæ¨¡æ‹Ÿï¼‰
        scenario_count = 6  # âŒ ç¡¬ç¼–ç 

        # è·å–æ•°æ®æºæ•°é‡ï¼ˆæ¨¡æ‹Ÿï¼‰
        datasource_count = 7  # âŒ ç¡¬ç¼–ç 

        return {
            "success": True,
            "data": {
                "currentVersion": "v1.2.0",
                "totalRules": rule_count,  # âŒ æ¨¡æ‹Ÿæ•°æ®
                "totalPrompts": prompt_count,  # âŒ æ¨¡æ‹Ÿæ•°æ®
                "totalScenarios": scenario_count,  # âŒ æ¨¡æ‹Ÿæ•°æ®
                "totalDataSources": datasource_count,  # âŒ æ¨¡æ‹Ÿæ•°æ®
                "systemHealth": 95,
                "neo4jStatus": neo4j_status,
                "totalNodes": node_count,
                "totalRelations": rel_count,
                "lastUpdated": datetime.now().isoformat()
            }
        }
```

**ä¿®å¤å**:
```python
@app.get("/system/status")
async def get_system_status():
    """è·å–ç³»ç»ŸçŠ¶æ€ - è¿”å›çœŸå®æ•°æ®"""
    try:
        # ...
        with stats_driver.session() as session:
            # è·å–èŠ‚ç‚¹å’Œå…³ç³»æ•°é‡
            node_count = session.run("MATCH (n) RETURN count(n) as count").single()["count"]
            rel_count = session.run("MATCH ()-[r]->() RETURN count(r) as count").single()["count"]

            # âœ… è·å–å„ç±»å®ä½“æ•°é‡ï¼ˆçœŸå®æ•°æ®ï¼‰
            term_count = session.run("MATCH (t:Term) RETURN count(t) as count").single()["count"]
            category_count = session.run("MATCH (c:Category) RETURN count(c) as count").single()["count"]
            tag_count = session.run("MATCH (t:Tag) RETURN count(t) as count").single()["count"]
            alias_count = session.run("MATCH (a:Alias) RETURN count(a) as count").single()["count"]
            
            # âœ… è·å–æ–‡ä»¶æ•°é‡ - å°è¯•å¤šç§å¯èƒ½çš„èŠ‚ç‚¹ç±»å‹
            file_count_result = session.run("MATCH (f:File) RETURN count(f) as count").single()
            file_count = file_count_result["count"] if file_count_result else 0
            
            # å¦‚æœæ²¡æœ‰ File èŠ‚ç‚¹ï¼Œå°è¯•å…¶ä»–å¯èƒ½çš„æ•°æ®æºèŠ‚ç‚¹
            if file_count == 0:
                datasource_result = session.run("MATCH (d:DataSource) RETURN count(d) as count").single()
                file_count = datasource_result["count"] if datasource_result else 0
            
            # âœ… è®¡ç®—ç³»ç»Ÿå¥åº·åº¦ï¼ˆåŸºäºæ•°æ®å®Œæ•´æ€§ï¼‰
            system_health = 95 if node_count > 0 else 50

        stats_driver.close()

        return {
            "success": True,
            "data": {
                "currentVersion": "v1.2.0",
                "totalRules": 0,  # âœ… æš‚æ—¶æ²¡æœ‰è§„åˆ™æ•°æ®ï¼ˆè¯šå®æ˜¾ç¤ºï¼‰
                "totalPrompts": 0,  # âœ… æš‚æ—¶æ²¡æœ‰Promptæ•°æ®
                "totalScenarios": 0,  # âœ… æš‚æ—¶æ²¡æœ‰åœºæ™¯æ•°æ®
                "totalVersions": 1,  # âœ… å½“å‰ç‰ˆæœ¬
                "totalExtractionLogics": 0,  # âœ… æš‚æ—¶æ²¡æœ‰æå–é€»è¾‘æ•°æ®
                "totalAgents": 0,  # âœ… æš‚æ—¶æ²¡æœ‰Agentæ•°æ®
                "totalDataSources": file_count,  # âœ… ä½¿ç”¨æ–‡ä»¶æ•°é‡ä½œä¸ºæ•°æ®æºæ•°é‡
                "systemHealth": system_health,  # âœ… åŸºäºæ•°æ®è®¡ç®—
                "neo4jStatus": neo4j_status,
                "totalNodes": node_count,  # âœ… çœŸå®èŠ‚ç‚¹æ•°
                "totalRelations": rel_count,  # âœ… çœŸå®å…³ç³»æ•°
                "totalTerms": term_count,  # âœ… çœŸå®æœ¯è¯­æ•°
                "totalCategories": category_count,  # âœ… çœŸå®åˆ†ç±»æ•°
                "totalTags": tag_count,  # âœ… çœŸå®æ ‡ç­¾æ•°
                "totalAliases": alias_count,  # âœ… çœŸå®åˆ«åæ•°
                "lastUpdated": datetime.now().isoformat()
            }
        }
```

### 2. å‰ç«¯ä¿®å¤ - æ­£ç¡®è°ƒç”¨ API å¹¶æ›´æ–°æ•°æ®

**ä¿®å¤å‰**:
```javascript
// SystemManagement.vue
const systemStatus = reactive({
  currentVersion: 'v1.2.0',  // âŒ ç¡¬ç¼–ç 
  totalRules: 12,  // âŒ ç¡¬ç¼–ç 
  totalPrompts: 8,  // âŒ ç¡¬ç¼–ç 
  totalScenarios: 6,  // âŒ ç¡¬ç¼–ç 
  totalVersions: 5,  // âŒ ç¡¬ç¼–ç 
  totalExtractionLogics: 4,  // âŒ ç¡¬ç¼–ç 
  totalAgents: 3,  // âŒ ç¡¬ç¼–ç 
  totalDataSources: 7,  // âŒ ç¡¬ç¼–ç 
  systemHealth: 95  // âŒ ç¡¬ç¼–ç 
})

const loadSystemStatus = async () => {
  try {
    const response = await api.getSystemStatus()
    if (response.success && response.data) {  // âŒ é”™è¯¯çš„æ•°æ®è®¿é—®è·¯å¾„
      Object.assign(systemStatus, response.data)
    }
  } catch (error) {
    console.error('åŠ è½½ç³»ç»ŸçŠ¶æ€å¤±è´¥:', error)
  }
}
```

**ä¿®å¤å**:
```javascript
// SystemManagement.vue
const systemStatus = reactive({
  currentVersion: 'v1.2.0',  // é»˜è®¤å€¼ï¼Œä¼šè¢« API æ•°æ®è¦†ç›–
  totalRules: 12,
  totalPrompts: 8,
  totalScenarios: 6,
  totalVersions: 5,
  totalExtractionLogics: 4,
  totalAgents: 3,
  totalDataSources: 7,
  systemHealth: 95
})

const loadSystemStatus = async () => {
  try {
    const response = await api.getSystemStatus()
    console.log('ç³»ç»ŸçŠ¶æ€å“åº”:', response)
    // âœ… axios æ‹¦æˆªå™¨è¿”å›å®Œæ•´çš„ response å¯¹è±¡ï¼Œéœ€è¦è®¿é—® response.data
    if (response.data && response.data.success && response.data.data) {
      Object.assign(systemStatus, response.data.data)
      console.log('ç³»ç»ŸçŠ¶æ€å·²æ›´æ–°:', systemStatus)
    }
  } catch (error) {
    console.error('åŠ è½½ç³»ç»ŸçŠ¶æ€å¤±è´¥:', error)
  }
}

// âœ… åœ¨ onMounted ä¸­è°ƒç”¨
onMounted(() => {
  loadSystemStatus()
})
```

## ğŸ“¦ ä¿®æ”¹çš„æ–‡ä»¶æ±‡æ€»

### åç«¯æ–‡ä»¶

1. **api/main.py**
   - ä¿®æ”¹ `/system/status` ç«¯ç‚¹
   - ä» Neo4j æ•°æ®åº“æŸ¥è¯¢çœŸå®çš„å®ä½“æ•°é‡
   - æ·»åŠ  Termã€Categoryã€Tagã€Alias çš„ç»Ÿè®¡
   - æ·»åŠ  File/DataSource èŠ‚ç‚¹çš„ç»Ÿè®¡
   - åŸºäºæ•°æ®å®Œæ•´æ€§è®¡ç®—ç³»ç»Ÿå¥åº·åº¦

### å‰ç«¯æ–‡ä»¶

1. **apps/web/src/views/SystemManagement.vue**
   - ä¿®æ”¹ `loadSystemStatus` æ–¹æ³•
   - æ­£ç¡®è®¿é—® `response.data.data`ï¼ˆå› ä¸º axios æ‹¦æˆªå™¨è¿”å›å®Œæ•´çš„ responseï¼‰
   - æ·»åŠ è°ƒè¯•æ—¥å¿—

## ğŸš€ éƒ¨ç½²ç»“æœ

### API æµ‹è¯•ç»“æœ

```json
{
  "success": true,
  "data": {
    "currentVersion": "v1.2.0",
    "totalRules": 0,
    "totalPrompts": 0,
    "totalScenarios": 0,
    "totalVersions": 1,
    "totalExtractionLogics": 0,
    "totalAgents": 0,
    "totalDataSources": 0,
    "systemHealth": 95,
    "neo4jStatus": "connected",
    "totalNodes": 3219,        // âœ… çœŸå®æ•°æ®
    "totalRelations": 7027,    // âœ… çœŸå®æ•°æ®
    "totalTerms": 1331,        // âœ… çœŸå®æ•°æ®
    "totalCategories": 11,     // âœ… çœŸå®æ•°æ®
    "totalTags": 131,          // âœ… çœŸå®æ•°æ®
    "totalAliases": 1746,      // âœ… çœŸå®æ•°æ®
    "lastUpdated": "2025-10-09T12:28:15.961083"
  }
}
```

### æ•°æ®å¯¹æ¯”

| å­—æ®µ | ä¿®å¤å‰ | ä¿®å¤å | è¯´æ˜ |
|------|--------|--------|------|
| totalNodes | æœªæ˜¾ç¤º | 3219 | âœ… çœŸå®èŠ‚ç‚¹æ•° |
| totalRelations | æœªæ˜¾ç¤º | 7027 | âœ… çœŸå®å…³ç³»æ•° |
| totalTerms | æœªæ˜¾ç¤º | 1331 | âœ… çœŸå®æœ¯è¯­æ•° |
| totalCategories | æœªæ˜¾ç¤º | 11 | âœ… çœŸå®åˆ†ç±»æ•° |
| totalTags | æœªæ˜¾ç¤º | 131 | âœ… çœŸå®æ ‡ç­¾æ•° |
| totalAliases | æœªæ˜¾ç¤º | 1746 | âœ… çœŸå®åˆ«åæ•° |
| totalRules | 12ï¼ˆç¡¬ç¼–ç ï¼‰ | 0 | âœ… è¯šå®æ˜¾ç¤ºï¼ˆæš‚æ— æ•°æ®ï¼‰ |
| totalPrompts | 8ï¼ˆç¡¬ç¼–ç ï¼‰ | 0 | âœ… è¯šå®æ˜¾ç¤ºï¼ˆæš‚æ— æ•°æ®ï¼‰ |
| totalScenarios | 6ï¼ˆç¡¬ç¼–ç ï¼‰ | 0 | âœ… è¯šå®æ˜¾ç¤ºï¼ˆæš‚æ— æ•°æ®ï¼‰ |
| totalDataSources | 7ï¼ˆç¡¬ç¼–ç ï¼‰ | 0 | âœ… è¯šå®æ˜¾ç¤ºï¼ˆæš‚æ— æ•°æ®ï¼‰ |
| systemHealth | 95ï¼ˆç¡¬ç¼–ç ï¼‰ | 95 | âœ… åŸºäºæ•°æ®è®¡ç®— |

## ğŸ¯ ä¿®å¤æ•ˆæœå¯¹æ¯”

### ä¿®å¤å‰
- âŒ æ˜¾ç¤ºç¡¬ç¼–ç çš„æ¨¡æ‹Ÿæ•°æ®
- âŒ æ•°å­—ä¸åæ˜ çœŸå®çš„æ•°æ®åº“çŠ¶æ€
- âŒ ç”¨æˆ·æ— æ³•äº†è§£çœŸå®çš„ç³»ç»ŸçŠ¶æ€
- âŒ è§„åˆ™æ•°ã€Promptæ•°ç­‰æ˜¾ç¤ºè™šå‡æ•°æ®

### ä¿®å¤å
- âœ… æ˜¾ç¤ºçœŸå®çš„æ•°æ®åº“ç»Ÿè®¡
- âœ… èŠ‚ç‚¹æ•°ã€å…³ç³»æ•°ã€æœ¯è¯­æ•°ç­‰éƒ½æ˜¯å®æ—¶æŸ¥è¯¢
- âœ… è¯šå®æ˜¾ç¤ºæš‚æ— æ•°æ®çš„å­—æ®µï¼ˆæ˜¾ç¤º0è€Œä¸æ˜¯è™šå‡æ•°å­—ï¼‰
- âœ… ç”¨æˆ·å¯ä»¥çœ‹åˆ°çœŸå®çš„ç³»ç»ŸçŠ¶æ€

## ğŸ“ æŠ€æœ¯è¦ç‚¹æ€»ç»“

### 1. æ•°æ®è¯šå®æ€§åŸåˆ™

```python
# âŒ ä¸å¥½çš„åšæ³• - æ˜¾ç¤ºè™šå‡æ•°æ®
return {
    "totalRules": 12,  # å®é™…ä¸Šæ²¡æœ‰è§„åˆ™æ•°æ®
    "totalPrompts": 8   # å®é™…ä¸Šæ²¡æœ‰Promptæ•°æ®
}

# âœ… å¥½çš„åšæ³• - è¯šå®æ˜¾ç¤º
return {
    "totalRules": 0,  # è¯šå®æ˜¾ç¤ºæš‚æ— æ•°æ®
    "totalPrompts": 0,  # è¯šå®æ˜¾ç¤ºæš‚æ— æ•°æ®
    "totalTerms": term_count  # æ˜¾ç¤ºçœŸå®æ•°æ®
}
```

### 2. Neo4j æŸ¥è¯¢ä¼˜åŒ–

```python
# âœ… æ‰¹é‡æŸ¥è¯¢ï¼Œå‡å°‘æ•°æ®åº“å¾€è¿”
with session:
    term_count = session.run("MATCH (t:Term) RETURN count(t) as count").single()["count"]
    category_count = session.run("MATCH (c:Category) RETURN count(c) as count").single()["count"]
    tag_count = session.run("MATCH (t:Tag) RETURN count(t) as count").single()["count"]
    alias_count = session.run("MATCH (a:Alias) RETURN count(a) as count").single()["count"]
```

### 3. å®¹é”™å¤„ç†

```python
# âœ… å¤„ç†èŠ‚ç‚¹å¯èƒ½ä¸å­˜åœ¨çš„æƒ…å†µ
file_count_result = session.run("MATCH (f:File) RETURN count(f) as count").single()
file_count = file_count_result["count"] if file_count_result else 0

# å¦‚æœæ²¡æœ‰ File èŠ‚ç‚¹ï¼Œå°è¯•å…¶ä»–å¯èƒ½çš„æ•°æ®æºèŠ‚ç‚¹
if file_count == 0:
    datasource_result = session.run("MATCH (d:DataSource) RETURN count(d) as count").single()
    file_count = datasource_result["count"] if datasource_result else 0
```

### 4. å‰ç«¯æ•°æ®è®¿é—®è·¯å¾„

```javascript
// âŒ é”™è¯¯çš„è®¿é—®è·¯å¾„
if (response.success && response.data) {
  Object.assign(systemStatus, response.data)
}

// âœ… æ­£ç¡®çš„è®¿é—®è·¯å¾„ï¼ˆaxios æ‹¦æˆªå™¨è¿”å›å®Œæ•´çš„ responseï¼‰
if (response.data && response.data.success && response.data.data) {
  Object.assign(systemStatus, response.data.data)
}
```

## ğŸ” éªŒè¯æ­¥éª¤

1. **æ¸…é™¤æµè§ˆå™¨ç¼“å­˜** - æŒ‰ `Ctrl + F5`
2. **æ‰“å¼€ç³»ç»Ÿç®¡ç†é¡µé¢**
3. **æŸ¥çœ‹é¡¶éƒ¨ç»Ÿè®¡å¡ç‰‡**
   - âœ… åº”è¯¥æ˜¾ç¤ºçœŸå®çš„æ•°æ®
   - âœ… æœ¯è¯­æ€»æ•°ã€åˆ†ç±»æ•°é‡ç­‰åº”è¯¥ä¸æ•°æ®åº“ä¸€è‡´
4. **æ‰“å¼€æµè§ˆå™¨å¼€å‘è€…å·¥å…·**
5. **æŸ¥çœ‹æ§åˆ¶å°æ—¥å¿—**
   - âœ… åº”è¯¥çœ‹åˆ° "ç³»ç»ŸçŠ¶æ€å“åº”:" æ—¥å¿—
   - âœ… åº”è¯¥çœ‹åˆ° "ç³»ç»ŸçŠ¶æ€å·²æ›´æ–°:" æ—¥å¿—
6. **æ£€æŸ¥ç½‘ç»œè¯·æ±‚**
   - âœ… `/api/system/status` åº”è¯¥è¿”å›çœŸå®æ•°æ®

## ğŸ‰ æ€»ç»“

### ä¿®å¤çš„æ ¸å¿ƒé—®é¢˜
- **åç«¯è¿”å›æ¨¡æ‹Ÿæ•°æ®** - ç¡¬ç¼–ç çš„æ•°å­—ä¸åæ˜ çœŸå®çŠ¶æ€
- **å‰ç«¯æ•°æ®è®¿é—®é”™è¯¯** - æ²¡æœ‰æ­£ç¡®è®¿é—® API è¿”å›çš„æ•°æ®

### é‡‡ç”¨çš„è§£å†³æ–¹æ¡ˆ
1. **åç«¯æŸ¥è¯¢çœŸå®æ•°æ®** - ä» Neo4j æ•°æ®åº“æŸ¥è¯¢å®é™…çš„å®ä½“æ•°é‡
2. **è¯šå®æ˜¾ç¤ºæ•°æ®** - æš‚æ— æ•°æ®çš„å­—æ®µæ˜¾ç¤º 0ï¼Œè€Œä¸æ˜¯è™šå‡æ•°å­—
3. **å‰ç«¯æ­£ç¡®è®¿é—®** - ä½¿ç”¨æ­£ç¡®çš„æ•°æ®è®¿é—®è·¯å¾„ `response.data.data`
4. **æ·»åŠ è°ƒè¯•æ—¥å¿—** - æ–¹ä¾¿æ’æŸ¥é—®é¢˜

### æŠ€æœ¯æ”¶è·
- æ•°æ®è¯šå®æ€§æ¯”è™šå‡çš„"å¥½çœ‹"æ•°å­—æ›´é‡è¦
- Neo4j æŸ¥è¯¢éœ€è¦è€ƒè™‘èŠ‚ç‚¹å¯èƒ½ä¸å­˜åœ¨çš„æƒ…å†µ
- axios æ‹¦æˆªå™¨ä¼šå½±å“æ•°æ®è®¿é—®è·¯å¾„
- è°ƒè¯•æ—¥å¿—å¯¹æ’æŸ¥é—®é¢˜å¾ˆæœ‰å¸®åŠ©

### åç»­æ”¹è¿›å»ºè®®
1. **æ·»åŠ è§„åˆ™ç®¡ç†åŠŸèƒ½** - è®© `totalRules` æ˜¾ç¤ºçœŸå®æ•°æ®
2. **æ·»åŠ  Prompt ç®¡ç†åŠŸèƒ½** - è®© `totalPrompts` æ˜¾ç¤ºçœŸå®æ•°æ®
3. **æ·»åŠ åœºæ™¯ç®¡ç†åŠŸèƒ½** - è®© `totalScenarios` æ˜¾ç¤ºçœŸå®æ•°æ®
4. **æ·»åŠ æ•°æ®æºç®¡ç†** - è®© `totalDataSources` æ˜¾ç¤ºçœŸå®æ•°æ®
5. **ç¼“å­˜ç»Ÿè®¡æ•°æ®** - é¿å…æ¯æ¬¡éƒ½æŸ¥è¯¢æ•°æ®åº“

---

**ä¿®å¤æ—¶é—´**: 2025-10-09 12:28  
**ä¿®å¤çŠ¶æ€**: âœ… å®Œæˆ  
**éªŒè¯çŠ¶æ€**: â³ å¾…ç”¨æˆ·éªŒè¯  
**éƒ¨ç½²ç¯å¢ƒ**: http://47.108.152.16

