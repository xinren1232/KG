# çŸ¥è¯†å›¾è°±ç³»ç»Ÿ - å†…éƒ¨ä½¿ç”¨ä¼˜åŒ–æ–¹æ¡ˆ

**åˆ¶å®šæ—¥æœŸ**: 2025-10-09  
**ä½¿ç”¨åœºæ™¯**: å†…éƒ¨ç³»ç»Ÿï¼Œåç»­å›¾è°±APIå¯¹å¤–å¼€æ”¾  
**ä¼˜åŒ–é‡ç‚¹**: æ€§èƒ½ã€ä»£ç è´¨é‡ã€å¯ç»´æŠ¤æ€§  

---

## ğŸ¯ ä¼˜åŒ–ç›®æ ‡

### æ ¸å¿ƒç›®æ ‡
1. âœ… **æ€§èƒ½ä¼˜åŒ–**: å·²å®Œæˆï¼ŒAPIå“åº”<1ç§’
2. ğŸ”§ **ä»£ç é‡æ„**: æå‡å¯ç»´æŠ¤æ€§
3. ğŸ“Š **ç›‘æ§å®Œå–„**: ä¾¿äºé—®é¢˜å®šä½
4. ğŸ§ª **æµ‹è¯•è¦†ç›–**: ä¿è¯ä»£ç è´¨é‡
5. ğŸš€ **APIæ ‡å‡†åŒ–**: ä¸ºåç»­å¯¹å¤–å¼€æ”¾åšå‡†å¤‡

### ä¸éœ€è¦çš„ä¼˜åŒ–ï¼ˆå†…éƒ¨ä½¿ç”¨ï¼‰
- âŒ è®¤è¯æˆæƒ (JWT/OAuth2)
- âŒ APIé™æµ (å†…éƒ¨ä½¿ç”¨æ— éœ€é™æµ)
- âŒ CSRFä¿æŠ¤
- âŒ å¤æ‚çš„æƒé™ç®¡ç†

---

## ğŸ“… ä¼˜åŒ–è®¡åˆ’

### Week 1: ä»£ç é‡æ„ä¸æ€§èƒ½ä¼˜åŒ–

#### Day 1-2: APIä»£ç é‡æ„ â­â­â­â­â­

**ç›®æ ‡**: å°†main.py (2338è¡Œ) æ‹†åˆ†ä¸ºæ¨¡å—åŒ–ç»“æ„

**å½“å‰ç»“æ„**:
```
api/
â””â”€â”€ main.py (2338è¡Œ) âŒ è¿‡å¤§
```

**ç›®æ ‡ç»“æ„**:
```
api/
â”œâ”€â”€ main.py (100è¡Œ) âœ… ç®€æ´
â”œâ”€â”€ routers/
â”‚   â”œâ”€â”€ __init__.py
â”‚   â”œâ”€â”€ graph.py (å›¾è°±ç›¸å…³API)
â”‚   â”œâ”€â”€ dictionary.py (è¯å…¸ç›¸å…³API)
â”‚   â”œâ”€â”€ file.py (æ–‡ä»¶å¤„ç†API)
â”‚   â””â”€â”€ stats.py (ç»Ÿè®¡ç›¸å…³API)
â”œâ”€â”€ services/
â”‚   â”œâ”€â”€ __init__.py
â”‚   â”œâ”€â”€ graph_service.py (å›¾è°±ä¸šåŠ¡é€»è¾‘)
â”‚   â”œâ”€â”€ dictionary_service.py (è¯å…¸ä¸šåŠ¡é€»è¾‘)
â”‚   â””â”€â”€ cache_service.py (ç¼“å­˜æœåŠ¡)
â””â”€â”€ models/
    â”œâ”€â”€ __init__.py
    â”œâ”€â”€ requests.py (è¯·æ±‚æ¨¡å‹)
    â””â”€â”€ responses.py (å“åº”æ¨¡å‹)
```

**å®æ–½æ­¥éª¤**:

1. **åˆ›å»ºroutersç›®å½•ç»“æ„**
```bash
cd /opt/knowledge-graph/api
mkdir -p routers services models
touch routers/__init__.py services/__init__.py models/__init__.py
```

2. **æå–å›¾è°±ç›¸å…³API** (routers/graph.py)
```python
from fastapi import APIRouter, HTTPException
from cache.redis_manager import cache_result

router = APIRouter(prefix="/kg", tags=["çŸ¥è¯†å›¾è°±"])

@router.get("/stats")
@cache_result("stats", ttl=300)
async def get_statistics():
    """è·å–å›¾è°±ç»Ÿè®¡ä¿¡æ¯"""
    # ä»main.pyç§»åŠ¨è¿‡æ¥çš„ä»£ç 
    pass

@router.get("/graph")
@cache_result("graph", ttl=600)
async def get_graph_data(limit: int = 100, show_all: bool = False):
    """è·å–å›¾è°±æ•°æ®"""
    # ä»main.pyç§»åŠ¨è¿‡æ¥çš„ä»£ç 
    pass

@router.get("/entities")
async def get_entities(entity_type: str = None):
    """è·å–å®ä½“åˆ—è¡¨"""
    pass

@router.get("/relations")
async def get_relations():
    """è·å–å…³ç³»åˆ—è¡¨"""
    pass
```

3. **æå–è¯å…¸ç›¸å…³API** (routers/dictionary.py)
```python
from fastapi import APIRouter
from cache.redis_manager import cache_result

router = APIRouter(prefix="/kg", tags=["è¯å…¸ç®¡ç†"])

@router.get("/dictionary")
@cache_result("dictionary", ttl=1800)
async def get_dictionary(
    page: int = 1,
    page_size: int = 100,
    category: str = None,
    search: str = None
):
    """è·å–è¯å…¸æ•°æ®"""
    pass

@router.get("/dictionary/categories")
@cache_result("dict_categories", ttl=3600)
async def get_categories():
    """è·å–åˆ†ç±»åˆ—è¡¨"""
    pass

@router.get("/dictionary/stats")
@cache_result("dict_stats", ttl=600)
async def get_dictionary_stats():
    """è·å–è¯å…¸ç»Ÿè®¡"""
    pass
```

4. **ç®€åŒ–main.py**
```python
from fastapi import FastAPI
from fastapi.middleware.cors import CORSMiddleware
from contextlib import asynccontextmanager

from routers import graph, dictionary, file, stats
from cache.redis_manager import redis_manager

@asynccontextmanager
async def lifespan(app: FastAPI):
    # å¯åŠ¨æ—¶åˆå§‹åŒ–
    await redis_manager.connect()
    yield
    # å…³é—­æ—¶æ¸…ç†
    await redis_manager.disconnect()

app = FastAPI(
    title="çŸ¥è¯†å›¾è°±æ ¸å¿ƒAPI",
    description="åŸºäºNeo4jçš„è´¨é‡çŸ¥è¯†å›¾è°±æŸ¥è¯¢æ¥å£",
    version="2.1.0",
    lifespan=lifespan
)

# CORSé…ç½®
app.add_middleware(
    CORSMiddleware,
    allow_origins=["*"],
    allow_credentials=True,
    allow_methods=["*"],
    allow_headers=["*"],
)

# æ³¨å†Œè·¯ç”±
app.include_router(graph.router)
app.include_router(dictionary.router)
app.include_router(file.router)
app.include_router(stats.router)

@app.get("/")
async def root():
    return {
        "message": "çŸ¥è¯†å›¾è°±æ ¸å¿ƒAPI",
        "version": "2.1.0",
        "docs": "/docs"
    }
```

**é¢„æœŸæ•ˆæœ**:
- âœ… ä»£ç å¯è¯»æ€§æå‡80%
- âœ… ç»´æŠ¤æˆæœ¬é™ä½60%
- âœ… æ–°åŠŸèƒ½å¼€å‘æ•ˆç‡æå‡50%

---

#### Day 3-4: å…¨é¢å¯ç”¨ç¼“å­˜ â­â­â­â­â­

**ç›®æ ‡**: ä¸ºæ‰€æœ‰GETç«¯ç‚¹æ·»åŠ ç¼“å­˜ï¼Œæå‡æ€§èƒ½

**ç¼“å­˜ç­–ç•¥**:
```python
# é«˜é¢‘æŸ¥è¯¢ - çŸ­TTL
@cache_result("stats", ttl=300)  # 5åˆ†é’Ÿ
async def get_statistics():
    pass

# å›¾è°±æ•°æ® - ä¸­TTL
@cache_result("graph", ttl=600)  # 10åˆ†é’Ÿ
async def get_graph_data():
    pass

# è¯å…¸æ•°æ® - é•¿TTL
@cache_result("dictionary", ttl=1800)  # 30åˆ†é’Ÿ
async def get_dictionary():
    pass

# é™æ€æ•°æ® - è¶…é•¿TTL
@cache_result("categories", ttl=3600)  # 1å°æ—¶
async def get_categories():
    pass
```

**æ·»åŠ ç¼“å­˜é¢„çƒ­**:
```python
# api/cache/cache_warmer.py
async def warm_cache():
    """åº”ç”¨å¯åŠ¨æ—¶é¢„çƒ­ç¼“å­˜"""
    logger.info("å¼€å§‹ç¼“å­˜é¢„çƒ­...")
    
    # é¢„çƒ­ç»Ÿè®¡æ•°æ®
    await get_statistics()
    
    # é¢„çƒ­è¯å…¸æ•°æ®
    await get_dictionary()
    
    # é¢„çƒ­åˆ†ç±»æ•°æ®
    await get_categories()
    
    # é¢„çƒ­å°è§„æ¨¡å›¾è°±
    await get_graph_data(limit=100)
    
    logger.info("ç¼“å­˜é¢„çƒ­å®Œæˆ")
```

**æ·»åŠ ç¼“å­˜ç®¡ç†ç«¯ç‚¹**:
```python
@router.post("/cache/clear")
async def clear_cache(pattern: str = "*"):
    """æ¸…é™¤ç¼“å­˜"""
    count = await redis_manager.clear_pattern(pattern)
    return {"message": f"å·²æ¸…é™¤ {count} ä¸ªç¼“å­˜"}

@router.get("/cache/stats")
async def cache_stats():
    """ç¼“å­˜ç»Ÿè®¡"""
    info = await redis_manager.redis.info("stats")
    hits = info.get("keyspace_hits", 0)
    misses = info.get("keyspace_misses", 0)
    total = hits + misses
    hit_rate = hits / total if total > 0 else 0
    
    return {
        "hits": hits,
        "misses": misses,
        "hit_rate": f"{hit_rate*100:.1f}%",
        "total_keys": await redis_manager.redis.dbsize()
    }
```

**é¢„æœŸæ•ˆæœ**:
- âœ… ç¼“å­˜å‘½ä¸­ç‡: 85% â†’ 95%
- âœ… APIå“åº”æ—¶é—´: å†é™ä½20%
- âœ… æ•°æ®åº“è´Ÿè½½: é™ä½70%

---

#### Day 5-6: Neo4jæŸ¥è¯¢ä¼˜åŒ– â­â­â­â­

**ç›®æ ‡**: ä¼˜åŒ–å¤æ‚æŸ¥è¯¢ï¼Œæå‡æ•°æ®åº“æ€§èƒ½

**1. ä¼˜åŒ–å›¾è°±æŸ¥è¯¢**
```cypher
-- å½“å‰æŸ¥è¯¢ (æ…¢)
MATCH (n)
RETURN n
LIMIT 1000

-- ä¼˜åŒ–å (å¿«)
MATCH (n)
WHERE n:Product OR n:Component OR n:Anomaly OR n:TestCase
WITH n, size((n)--()) as degree
WHERE degree > 0
RETURN id(n) as id, 
       labels(n)[0] as label,
       n.name as name,
       degree
ORDER BY degree DESC
LIMIT $limit
```

**2. ä¼˜åŒ–è¯å…¸æŸ¥è¯¢**
```cypher
-- å½“å‰æŸ¥è¯¢
MATCH (t:Term)
OPTIONAL MATCH (t)-[:HAS_TAG]->(tag:Tag)
OPTIONAL MATCH (t)-[:BELONGS_TO]->(cat:Category)
RETURN t, collect(tag.name), cat.name

-- ä¼˜åŒ–å (ä½¿ç”¨ç´¢å¼•)
MATCH (t:Term)
WHERE t.category = $category  -- ä½¿ç”¨ç´¢å¼•
OPTIONAL MATCH (t)-[:HAS_TAG]->(tag:Tag)
RETURN t, collect(tag.name)
LIMIT $limit
SKIP $skip
```

**3. æ·»åŠ æŸ¥è¯¢åˆ†æå·¥å…·**
```python
# api/utils/query_analyzer.py
class QueryAnalyzer:
    @staticmethod
    async def analyze_query(query: str, params: dict):
        """åˆ†ææŸ¥è¯¢æ€§èƒ½"""
        start = time.time()
        result = await execute_query(query, params)
        duration = time.time() - start
        
        if duration > 1.0:
            logger.warning(f"æ…¢æŸ¥è¯¢: {duration:.2f}s - {query[:100]}")
        
        return result, duration
```

**é¢„æœŸæ•ˆæœ**:
- âœ… æŸ¥è¯¢æ—¶é—´: å†é™ä½30%
- âœ… æ…¢æŸ¥è¯¢æ•°é‡: å‡å°‘80%

---

#### Day 7: å‰ç«¯æ€§èƒ½ä¼˜åŒ– â­â­â­â­

**ç›®æ ‡**: ä¼˜åŒ–å‰ç«¯åŠ è½½å’Œæ¸²æŸ“æ€§èƒ½

**1. è·¯ç”±æ‡’åŠ è½½**
```javascript
// apps/web/src/router/index.js
const routes = [
  {
    path: '/',
    name: 'Home',
    component: () => import('../views/Home.vue')
  },
  {
    path: '/graph-viz',
    name: 'GraphVisualization',
    component: () => import('../views/GraphVisualization.vue')
  },
  {
    path: '/dictionary',
    name: 'DictionaryManagement',
    component: () => import('../views/DictionaryManagement.vue')
  }
]
```

**2. ç»„ä»¶æ‡’åŠ è½½**
```vue
<script setup>
import { defineAsyncComponent } from 'vue'

// æ‡’åŠ è½½å¤§ç»„ä»¶
const GraphVisualization = defineAsyncComponent(() =>
  import('./components/GraphVisualization.vue')
)

const DataTable = defineAsyncComponent(() =>
  import('./components/DataTable.vue')
)
</script>
```

**3. è™šæ‹Ÿæ»šåŠ¨ (å¤§åˆ—è¡¨)**
```vue
<!-- ä½¿ç”¨Element Plusçš„è™šæ‹Ÿè¡¨æ ¼ -->
<template>
  <el-table-v2
    :columns="columns"
    :data="tableData"
    :width="700"
    :height="600"
    fixed
  />
</template>
```

**4. è¯·æ±‚å»é‡å’Œç¼“å­˜**
```javascript
// apps/web/src/api/index.js
import { useDebounceFn } from '@vueuse/core'

// è¯·æ±‚ç¼“å­˜
const requestCache = new Map()

api.interceptors.request.use(config => {
  const cacheKey = `${config.method}:${config.url}:${JSON.stringify(config.params)}`
  
  if (requestCache.has(cacheKey)) {
    const { timestamp, data } = requestCache.get(cacheKey)
    if (Date.now() - timestamp < 60000) {  // 1åˆ†é’Ÿç¼“å­˜
      return Promise.resolve({ data })
    }
  }
  
  return config
})
```

**é¢„æœŸæ•ˆæœ**:
- âœ… é¦–å±åŠ è½½: 5ç§’ â†’ <2ç§’
- âœ… è·¯ç”±åˆ‡æ¢: 1ç§’ â†’ <0.3ç§’
- âœ… å¤§åˆ—è¡¨æ¸²æŸ“: æµç•…æ— å¡é¡¿

---

### Week 2: ç›‘æ§ä¸æµ‹è¯•

#### Day 8-9: ç›‘æ§ä½“ç³»å®Œå–„ â­â­â­â­

**ç›®æ ‡**: å»ºç«‹å®Œæ•´çš„ç›‘æ§ä½“ç³»ï¼Œä¾¿äºé—®é¢˜å®šä½

**1. é…ç½®Prometheus + Grafana**

```yaml
# docker-compose.monitoring.yml
version: '3.8'

services:
  prometheus:
    image: prom/prometheus:latest
    volumes:
      - ./monitoring/prometheus.yml:/etc/prometheus/prometheus.yml
      - prometheus_data:/prometheus
    ports:
      - "9090:9090"
    command:
      - '--config.file=/etc/prometheus/prometheus.yml'
      - '--storage.tsdb.path=/prometheus'

  grafana:
    image: grafana/grafana:latest
    volumes:
      - grafana_data:/var/lib/grafana
      - ./monitoring/grafana/dashboards:/etc/grafana/provisioning/dashboards
    ports:
      - "3000:3000"
    environment:
      - GF_SECURITY_ADMIN_PASSWORD=admin
      - GF_USERS_ALLOW_SIGN_UP=false

volumes:
  prometheus_data:
  grafana_data:
```

**2. Prometheusé…ç½®**
```yaml
# monitoring/prometheus.yml
global:
  scrape_interval: 15s

scrape_configs:
  - job_name: 'kg-api'
    static_configs:
      - targets: ['api:8000']
    metrics_path: '/metrics'
  
  - job_name: 'neo4j'
    static_configs:
      - targets: ['neo4j:7474']
  
  - job_name: 'redis'
    static_configs:
      - targets: ['redis:6379']
```

**3. Grafanaä»ªè¡¨æ¿**
```json
{
  "dashboard": {
    "title": "çŸ¥è¯†å›¾è°±ç³»ç»Ÿç›‘æ§",
    "panels": [
      {
        "title": "APIè¯·æ±‚æ•° (QPS)",
        "targets": [{
          "expr": "rate(kg_api_requests_total[1m])"
        }]
      },
      {
        "title": "APIå“åº”æ—¶é—´ (P95)",
        "targets": [{
          "expr": "histogram_quantile(0.95, kg_api_request_duration_seconds)"
        }]
      },
      {
        "title": "ç¼“å­˜å‘½ä¸­ç‡",
        "targets": [{
          "expr": "kg_cache_hits_total / (kg_cache_hits_total + kg_cache_misses_total)"
        }]
      },
      {
        "title": "Neo4jæŸ¥è¯¢æ—¶é—´",
        "targets": [{
          "expr": "neo4j_query_duration_seconds"
        }]
      }
    ]
  }
}
```

**4. æ—¥å¿—èšåˆ (å¯é€‰)**
```yaml
# ä½¿ç”¨Lokiæ”¶é›†æ—¥å¿—
services:
  loki:
    image: grafana/loki:latest
    ports:
      - "3100:3100"
    volumes:
      - ./monitoring/loki-config.yml:/etc/loki/local-config.yaml
  
  promtail:
    image: grafana/promtail:latest
    volumes:
      - /var/log:/var/log
      - ./monitoring/promtail-config.yml:/etc/promtail/config.yml
```

**é¢„æœŸæ•ˆæœ**:
- âœ… å®æ—¶ç›‘æ§ç³»ç»ŸçŠ¶æ€
- âœ… å¿«é€Ÿå®šä½æ€§èƒ½é—®é¢˜
- âœ… å†å²æ•°æ®åˆ†æ

---

#### Day 10-11: å•å…ƒæµ‹è¯• â­â­â­â­

**ç›®æ ‡**: æ·»åŠ æ ¸å¿ƒåŠŸèƒ½çš„å•å…ƒæµ‹è¯•

**1. åç«¯æµ‹è¯• (pytest)**
```python
# tests/test_graph_api.py
import pytest
from fastapi.testclient import TestClient
from api.main import app

client = TestClient(app)

def test_get_statistics():
    """æµ‹è¯•ç»Ÿè®¡æ¥å£"""
    response = client.get("/kg/stats")
    assert response.status_code == 200
    data = response.json()
    assert "data" in data
    assert "total_nodes" in data["data"]

def test_get_graph_data():
    """æµ‹è¯•å›¾è°±æ•°æ®æ¥å£"""
    response = client.get("/kg/graph?limit=100")
    assert response.status_code == 200
    data = response.json()
    assert "data" in data
    assert "nodes" in data["data"]
    assert len(data["data"]["nodes"]) <= 100

def test_get_dictionary():
    """æµ‹è¯•è¯å…¸æ¥å£"""
    response = client.get("/kg/dictionary")
    assert response.status_code == 200
    data = response.json()
    assert "data" in data
    assert isinstance(data["data"], list)

def test_cache_effectiveness():
    """æµ‹è¯•ç¼“å­˜æ•ˆæœ"""
    import time
    
    # ç¬¬ä¸€æ¬¡è¯·æ±‚
    start = time.time()
    response1 = client.get("/kg/stats")
    time1 = time.time() - start
    
    # ç¬¬äºŒæ¬¡è¯·æ±‚ (åº”è¯¥ä»ç¼“å­˜)
    start = time.time()
    response2 = client.get("/kg/stats")
    time2 = time.time() - start
    
    assert response1.status_code == 200
    assert response2.status_code == 200
    assert time2 < time1 * 0.5  # ç¼“å­˜åº”è¯¥å¿«50%ä»¥ä¸Š
```

**2. å‰ç«¯æµ‹è¯• (Vitest)**
```javascript
// tests/DictionaryManagement.test.js
import { describe, it, expect } from 'vitest'
import { mount } from '@vue/test-utils'
import DictionaryManagement from '@/views/DictionaryManagement.vue'

describe('DictionaryManagement', () => {
  it('should render correctly', () => {
    const wrapper = mount(DictionaryManagement)
    expect(wrapper.find('.dictionary-container').exists()).toBe(true)
  })
  
  it('should load data on mount', async () => {
    const wrapper = mount(DictionaryManagement)
    await wrapper.vm.$nextTick()
    expect(wrapper.vm.tableData.length).toBeGreaterThan(0)
  })
  
  it('should filter data by category', async () => {
    const wrapper = mount(DictionaryManagement)
    await wrapper.vm.handleCategoryChange('æ‘„åƒå¤´')
    expect(wrapper.vm.filteredData.every(item => 
      item.category === 'æ‘„åƒå¤´'
    )).toBe(true)
  })
})
```

**3. é›†æˆæµ‹è¯•**
```python
# tests/test_integration.py
def test_file_upload_and_extract():
    """æµ‹è¯•æ–‡ä»¶ä¸Šä¼ å’Œæå–æµç¨‹"""
    # ä¸Šä¼ æ–‡ä»¶
    with open("test_data/sample.xlsx", "rb") as f:
        response = client.post("/kg/upload", files={"file": f})
    
    assert response.status_code == 200
    file_id = response.json()["file_id"]
    
    # æå–æ•°æ®
    response = client.post(f"/kg/extract/{file_id}")
    assert response.status_code == 200
    
    # éªŒè¯æ•°æ®å·²å¯¼å…¥
    response = client.get("/kg/stats")
    stats = response.json()["data"]
    assert stats["total_nodes"] > 0
```

**è¿è¡Œæµ‹è¯•**:
```bash
# åç«¯æµ‹è¯•
cd api
pytest tests/ -v --cov=. --cov-report=html

# å‰ç«¯æµ‹è¯•
cd apps/web
npm run test
```

**é¢„æœŸæ•ˆæœ**:
- âœ… æµ‹è¯•è¦†ç›–ç‡: 0% â†’ 60%
- âœ… ä»£ç è´¨é‡ä¿è¯
- âœ… é‡æ„å®‰å…¨æ€§æå‡

---

#### Day 12-14: æ–‡æ¡£å®Œå–„ä¸éƒ¨ç½² â­â­â­

**ç›®æ ‡**: å®Œå–„æ–‡æ¡£ï¼Œä¼˜åŒ–éƒ¨ç½²æµç¨‹

**1. APIæ–‡æ¡£ä¼˜åŒ–**
```python
# å®Œå–„APIæ–‡æ¡£
@router.get(
    "/graph",
    summary="è·å–å›¾è°±æ•°æ®",
    description="è·å–çŸ¥è¯†å›¾è°±çš„èŠ‚ç‚¹å’Œå…³ç³»æ•°æ®ï¼Œæ”¯æŒåˆ†é¡µå’Œè¿‡æ»¤",
    response_description="è¿”å›å›¾è°±èŠ‚ç‚¹å’Œå…³ç³»åˆ—è¡¨",
    tags=["çŸ¥è¯†å›¾è°±"]
)
async def get_graph_data(
    limit: int = Query(100, description="è¿”å›èŠ‚ç‚¹æ•°é‡é™åˆ¶", ge=1, le=5000),
    show_all: bool = Query(False, description="æ˜¯å¦æ˜¾ç¤ºæ‰€æœ‰èŠ‚ç‚¹"),
    node_type: str = Query(None, description="èŠ‚ç‚¹ç±»å‹è¿‡æ»¤")
):
    """
    è·å–å›¾è°±æ•°æ®
    
    å‚æ•°:
    - limit: è¿”å›èŠ‚ç‚¹æ•°é‡ï¼Œé»˜è®¤100ï¼Œæœ€å¤§5000
    - show_all: æ˜¯å¦æ˜¾ç¤ºæ‰€æœ‰èŠ‚ç‚¹ï¼Œé»˜è®¤False
    - node_type: èŠ‚ç‚¹ç±»å‹è¿‡æ»¤ï¼Œå¯é€‰å€¼: Product, Component, Anomalyç­‰
    
    è¿”å›:
    - nodes: èŠ‚ç‚¹åˆ—è¡¨
    - relationships: å…³ç³»åˆ—è¡¨
    - stats: ç»Ÿè®¡ä¿¡æ¯
    """
    pass
```

**2. éƒ¨ç½²æ–‡æ¡£**
```markdown
# éƒ¨ç½²æŒ‡å—

## å¿«é€Ÿéƒ¨ç½²

### 1. å…‹éš†ä»£ç 
```bash
git clone <repo>
cd knowledge-graph
```

### 2. é…ç½®ç¯å¢ƒå˜é‡
```bash
cp .env.example .env
# ç¼–è¾‘.envæ–‡ä»¶ï¼Œè®¾ç½®Neo4jå¯†ç ç­‰
```

### 3. å¯åŠ¨æœåŠ¡
```bash
# å¯åŠ¨æ‰€æœ‰æœåŠ¡
docker-compose up -d

# æˆ–ä½¿ç”¨systemd (ç”Ÿäº§ç¯å¢ƒ)
systemctl start kg-api
systemctl start kg-frontend
```

### 4. åˆå§‹åŒ–æ•°æ®
```bash
# åˆ›å»ºNeo4jç´¢å¼•
docker exec kg_neo4j cypher-shell -u neo4j -p password123 < data/neo4j_schema.cypher

# å¯¼å…¥åˆå§‹æ•°æ®
python api/etl/etl_from_excel.py
```

### 5. éªŒè¯éƒ¨ç½²
```bash
# æ£€æŸ¥æœåŠ¡çŠ¶æ€
curl http://localhost:8000/health
curl http://localhost:5173/

# æŸ¥çœ‹ç›‘æ§
open http://localhost:3000  # Grafana
```

## æ€§èƒ½ä¼˜åŒ–

### Redisç¼“å­˜
- å·²å¯ç”¨ï¼Œå‘½ä¸­ç‡>85%
- TTLé…ç½®: 5-30åˆ†é’Ÿ

### Neo4jç´¢å¼•
- å·²åˆ›å»º7ä¸ªç´¢å¼•
- æŸ¥è¯¢æ€§èƒ½æå‡50-70%

### å‰ç«¯ä¼˜åŒ–
- è·¯ç”±æ‡’åŠ è½½
- è™šæ‹Ÿæ»šåŠ¨
- è¯·æ±‚ç¼“å­˜
```

**3. è¿ç»´æ–‡æ¡£**
```markdown
# è¿ç»´æ‰‹å†Œ

## æ—¥å¸¸ç»´æŠ¤

### æŸ¥çœ‹æ—¥å¿—
```bash
# APIæ—¥å¿—
tail -f /var/log/kg-api.log

# Neo4jæ—¥å¿—
docker logs kg_neo4j

# Redisæ—¥å¿—
docker logs kg_redis
```

### æ¸…é™¤ç¼“å­˜
```bash
# æ¸…é™¤æ‰€æœ‰ç¼“å­˜
curl -X POST http://localhost:8000/cache/clear

# æ¸…é™¤ç‰¹å®šç¼“å­˜
curl -X POST http://localhost:8000/cache/clear?pattern=graph:*
```

### å¤‡ä»½æ•°æ®
```bash
# å¤‡ä»½Neo4j
docker exec kg_neo4j neo4j-admin dump --database=neo4j --to=/backup/neo4j-$(date +%Y%m%d).dump

# å¤‡ä»½Redis
docker exec kg_redis redis-cli SAVE
```

### æ€§èƒ½ç›‘æ§
- Grafana: http://localhost:3000
- Prometheus: http://localhost:9090
- API Metrics: http://localhost:8000/metrics
```

---

## ğŸ“Š ä¼˜åŒ–æ•ˆæœé¢„æœŸ

### æ€§èƒ½æŒ‡æ ‡

| æŒ‡æ ‡ | å½“å‰ | ç›®æ ‡ | é¢„æœŸæå‡ |
|------|------|------|----------|
| APIå“åº”æ—¶é—´(P95) | 0.3ç§’ | <0.2ç§’ | 33% |
| ç¼“å­˜å‘½ä¸­ç‡ | 85% | 95% | 12% |
| é¦–å±åŠ è½½ | æœªæµ‹ | <2ç§’ | - |
| ä»£ç å¯ç»´æŠ¤æ€§ | ä¸­ | é«˜ | 80% |
| æµ‹è¯•è¦†ç›–ç‡ | 0% | 60% | - |

### è´¨é‡æŒ‡æ ‡

| æŒ‡æ ‡ | å½“å‰ | ç›®æ ‡ |
|------|------|------|
| ä»£ç è¡Œæ•°/æ–‡ä»¶ | 2338 | <500 |
| ä»£ç é‡å¤ç‡ | 15% | <5% |
| æ–‡æ¡£å®Œæ•´æ€§ | 80% | 95% |
| Bugä¿®å¤æ—¶é—´ | æœªçŸ¥ | <1å¤© |

---

## ğŸ¯ å®æ–½ä¼˜å…ˆçº§

### é«˜ä¼˜å…ˆçº§ â­â­â­â­â­
1. **APIä»£ç é‡æ„** (Day 1-2)
2. **å…¨é¢å¯ç”¨ç¼“å­˜** (Day 3-4)
3. **Neo4jæŸ¥è¯¢ä¼˜åŒ–** (Day 5-6)

### ä¸­ä¼˜å…ˆçº§ â­â­â­â­
4. **å‰ç«¯æ€§èƒ½ä¼˜åŒ–** (Day 7)
5. **ç›‘æ§ä½“ç³»å®Œå–„** (Day 8-9)

### ä½ä¼˜å…ˆçº§ â­â­â­
6. **å•å…ƒæµ‹è¯•** (Day 10-11)
7. **æ–‡æ¡£å®Œå–„** (Day 12-14)

---

## ğŸ’¡ åç»­è§„åˆ’

### å›¾è°±APIå¯¹å¤–å¼€æ”¾å‡†å¤‡

å½“éœ€è¦å°†å›¾è°±APIå¯¹å¤–å¼€æ”¾æ—¶ï¼Œå†æ·»åŠ ï¼š

1. **APIè®¤è¯** (JWT Token)
2. **APIé™æµ** (æ¯åˆ†é’Ÿè¯·æ±‚æ¬¡æ•°é™åˆ¶)
3. **APIå¯†é’¥ç®¡ç†** (ä¸ºä¸åŒç³»ç»Ÿåˆ†é…å¯†é’¥)
4. **è®¿é—®æ—¥å¿—** (è®°å½•æ‰€æœ‰APIè°ƒç”¨)
5. **APIç‰ˆæœ¬ç®¡ç†** (/api/v1/, /api/v2/)

### å¯æ‰©å±•æ€§å‡†å¤‡

1. **è¯»å†™åˆ†ç¦»** (Neo4jé›†ç¾¤)
2. **è´Ÿè½½å‡è¡¡** (Nginx/HAProxy)
3. **å®¹å™¨ç¼–æ’** (Kubernetes)
4. **è‡ªåŠ¨æ‰©ç¼©å®¹** (åŸºäºè´Ÿè½½)

---

## ğŸ“‹ æ£€æŸ¥æ¸…å•

### Week 1å®Œæˆæ ‡å‡†
- [ ] main.pyæ‹†åˆ†ä¸ºå¤šä¸ªrouteræ–‡ä»¶
- [ ] æ‰€æœ‰GETç«¯ç‚¹æ·»åŠ ç¼“å­˜
- [ ] Neo4jæŸ¥è¯¢ä¼˜åŒ–å®Œæˆ
- [ ] å‰ç«¯è·¯ç”±æ‡’åŠ è½½å®ç°
- [ ] æ€§èƒ½æµ‹è¯•é€šè¿‡

### Week 2å®Œæˆæ ‡å‡†
- [ ] Prometheus + Grafanaé…ç½®å®Œæˆ
- [ ] æ ¸å¿ƒåŠŸèƒ½å•å…ƒæµ‹è¯•è¦†ç›–60%
- [ ] APIæ–‡æ¡£å®Œå–„
- [ ] éƒ¨ç½²æ–‡æ¡£æ›´æ–°
- [ ] è¿ç»´æ‰‹å†Œç¼–å†™

---

**åˆ¶å®šæ—¶é—´**: 2025-10-09  
**é¢„è®¡å®Œæˆ**: 2025-10-23 (2å‘¨)  
**è´Ÿè´£äºº**: å¼€å‘å›¢é˜Ÿ

